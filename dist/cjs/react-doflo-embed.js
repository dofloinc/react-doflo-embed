"use strict";var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e);module.exports=function(t){var r=e.useRef(null),o=e.useRef([]),i=e.useState(!1),a=i[0],c=i[1],s=e.useState(t.src),l=s[0],u=s[1],d=e.useState(!1),w=d[0],f=d[1],p=e.useState("300px"),m=p[0],g=p[1],h=e.useState(.01),v=h[0],E=h[1];e.useEffect((function(){r.current&&o.current.length>0&&(o.current.forEach((function(e){x(e)})),o.current=[])}),[r.current]);var x=e.useCallback((function(e){if(e.data.split){var t=e.data.split(":"),n=t[2];if(r.current){if(r.current.src.split("?")[0].indexOf(n)>-1){switch(t[0]){case"scrollIntoView":r.current.scrollIntoView();break;case"setHeight":g("".concat(t[1],"px")),E(1);break;case"collapseErrorPage":r.current.clientHeight>window.innerHeight&&g("".concat(t[1],"px"));break;case"reloadPage":window.location.reload()}if(e.origin.indexOf("doflo")>-1&&r.current&&"contentWindow"in r.current&&"postMessage"in r.current.contentWindow){var i={docurl:encodeURIComponent(window.document.URL),referrer:encodeURIComponent(window.document.referrer)};r.current.contentWindow.postMessage(JSON.stringify({type:"urls",value:i}),"*")}}}else o.current.push(e)}}),[]);return e.useEffect((function(){if(r.current&&!w){f(!0);var e=l,t=[];if(window.location.href&&window.location.href.indexOf("?")>-1&&(t=t.concat(window.location.href.split("?")[1].split("&"))),e&&e.indexOf("?")>-1){var n=e.split("?");t=t.concat(n[1].split("&")),e=n[0]}t.push("isIframeEmbed=1"),u(e+"?"+t.join("&"))}return window.addEventListener&&!a?(c(!0),window.addEventListener("message",x,!1)):window.attachEvent&&!a&&(c(!0),window.attachEvent("onmessage",x)),function(){window.removeEventListener&&a?(c(!1),window.removeEventListener("message",x,!1)):window.detachEvent&&a&&(c(!1),window.detachEvent("onmessage",x))}})),n.default.createElement("iframe",{ref:r,style:{height:m,transition:"opacity 0.3s linear",width:"100%",opacity:v},className:t.className,allow:"geolocation; microphone; camera",sandbox:"allow-same-origin allow-scripts allow-modals allow-forms",src:l,frameBorder:0,scrolling:t.scrolling?"yes":"no"})};
//# sourceMappingURL=react-doflo-embed.js.map
